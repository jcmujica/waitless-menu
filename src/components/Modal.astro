---
import { Image } from "astro:assets";
import type { MenuItem } from "@/types/menu";

interface Props {
  item: MenuItem;
  settings: {
    showPrices: boolean;
    showImages: boolean;
    showDescriptions: boolean;
  };
}

const { item, settings } = Astro.props;
const { name, price, image_url, description } = item || {};
const { showPrices, showImages, showDescriptions } = settings;

// Helper function to format price
const formatPrice = (price: number) => {
  return new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD",
  }).format(price);
};
---

<el-dialog>
  <dialog
    id="dialog"
    aria-labelledby="dialog-title"
    class="fixed inset-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent backdrop:bg-transparent"
  >
    <el-dialog-backdrop
      class="fixed inset-0 bg-black/70 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"
    ></el-dialog-backdrop>

    <div
      tabindex="0"
      class="flex min-h-full items-center justify-center p-4 text-center focus:outline-none sm:p-0"
    >
      <el-dialog-panel
        class="relative w-full max-w-md transform overflow-hidden rounded-lg bg-primary-100 text-left shadow-xl transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 data-closed:sm:translate-y-0 data-closed:sm:scale-95"
      >
        {/* Header with close button */}
        <div class="flex items-center justify-between p-4 border-b border-primary-200">
          <h3 id="dialog-title" class="text-xl font-bold">
            {name}
          </h3>
          <button
            type="button"
            data-command="close"
            data-commandfor="dialog"
            class="hover:text-primary-500 focus:outline-none"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
        
        {/* Content */}
        <div class="p-6">
          <div class="flex flex-col gap-4">
            {showImages && image_url && (
              <div class="w-full h-48 rounded-md overflow-hidden">
                <Image
                  class="w-full h-full object-cover object-center"
                  src={image_url}
                  alt={name || ""}
                  width={400}
                  height={300}
                  inferSize
                />
              </div>
            )}
            
            {showDescriptions && description && (
              <div class="mt-2">
                <h4 class="text-sm font-medium">Description</h4>
                <p class="text-sm text-muted-foreground">{description}</p>
              </div>
            )}
            
            {showPrices && price !== null && price !== undefined && (
              <div class="mt-2">
                <h4 class="text-sm font-medium">Price</h4>
                <p class="text-xl font-bold text-primary-500">{formatPrice(price)}</p>
              </div>
            )}
          </div>
        </div>
        
        {/* Footer */}
        <div class="bg-primary-200 px-4 py-3 flex justify-end gap-2">
          <button
            type="button"
            data-command="close"
            data-commandfor="dialog"
            class="inline-flex justify-center rounded-md bg-primary-500 px-4 py-2 text-sm font-medium text-white hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"
          >
            Close
          </button>
        </div>
      </el-dialog-panel>
    </div>
  </dialog>
</el-dialog>
