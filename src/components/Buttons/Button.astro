---
interface Props {
  href: string;
  variant?: "primary" | "secondary" | "outline" | "ghost";
  /** 
   * Prefetch strategy:
   * - 'viewport': Prefetch when visible (best for menu buttons - works on mobile)
   * - 'hover': Prefetch on hover (desktop only)
   * - 'tap': Prefetch on touchstart (mobile)
   * - 'load': Prefetch immediately
   * - false: Disable prefetch
   */
  prefetch?: 'viewport' | 'hover' | 'tap' | 'load' | false;
}

// Base classes shared by all button variants
const baseClasses =
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive h-9 px-4 py-2 has-[>svg]:px-3";
// Variant-specific classes with auto-contrast text
const variantClasses = {
  primary:
    "bg-[var(--primary-500)] text-[var(--primary-500-contrast)] shadow-xs hover:bg-[var(--primary-600)] hover:text-[var(--primary-600-contrast)]",
  secondary:
    "bg-[var(--primary-100)] text-[var(--primary-100-contrast)] shadow-xs hover:bg-[var(--primary-200)] hover:text-[var(--primary-200-contrast)]",
  outline:
    "border border-[var(--primary-500)] text-[var(--primary-500)] bg-background shadow-xs hover:bg-[var(--primary-50)] dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
  ghost:
    "text-[var(--primary-600)] hover:bg-[var(--primary-50)] hover:text-[var(--primary-700)] dark:hover:bg-accent/50",
};

// Default to 'viewport' - works on both desktop and mobile
const { href, variant = "primary", prefetch = 'viewport' } = Astro.props;
---

<a 
  href={href}
  data-astro-prefetch={prefetch ? prefetch : undefined}
>
  <button
    type="button"
    class={`cursor-pointer w-full max-w-xs mx-auto ${baseClasses} ${variantClasses[variant]}`}
  >
    <slot />
  </button>
</a>
