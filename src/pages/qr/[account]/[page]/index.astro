---
import { fetchMenu } from "@/services/menus/fetch-menu";
import type { IMenu, MenuPage } from "@/types/menu";
import Menu from "@/components/Menu.astro";
import MenuLayout from "@/layouts/MenuLayout.astro";

const { account, page: pageId } = Astro.params;
const { data, error } = await fetchMenu(account as string);
const menu = data as IMenu;

// Find the current page
const currentPage = menu?.pages?.find((page: MenuPage) => page.id === pageId);
---

<MenuLayout>
  <Menu
    menu={menu}
    account={account}
    pageId={pageId}
    currentPage={currentPage}
    error={error}
  />
</MenuLayout>
