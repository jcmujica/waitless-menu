---
import { fetchMenuByPath } from "@/services/menus/fetch-menu-by-path";
import type { IMenu, MenuPage } from "@/types/menu";
import Menu from "@/components/Menu.astro";

const { accountPath, page: pageId } = Astro.params;
const { data, error } = await fetchMenuByPath(accountPath as string);
const menu = data as IMenu;

// Find the current page
const currentPage = menu?.pages?.find((page: MenuPage) => page.id === pageId);
---

<Menu 
  menu={menu}
  accountPath={accountPath}
  pageId={pageId}
  currentPage={currentPage}
  error={error}
/>